@model PasswordRecoveryConfirmModel
@{
    Layout = "_ColumnsOne";

    //title
    NopHtml.AddTitleParts(T("PageTitle.PasswordRecovery").Text);
}

<section class="login-sec d-flex align-items-center justify-content-center">
    <div class="container">
        <div class="login-cart forgot-password z9 position-relative">
            @if (!string.IsNullOrEmpty(Model.Result))
            {
                <div class="login-hading text-center">
                </div>
                <p>@Model.Result</p>
                <div class="forgotandlogin-cmn">
                    <button class="loginbtn w-100 mb-5 mt-4" onclick="window.location.href='@Model.ReturnUrl'">@T("Common.Continue")</button>
                </div>
            }
            @if (!Model.DisablePasswordChanging)
            {
                <form asp-route="PasswordRecoveryConfirm" asp-route-token="@Context.Request.Query["token"]" asp-route-guid="@Context.Request.Query["guid"]" method="post" autocomplete="off">
                    <div class="login-hading text-center">
                        Recover Password
                    </div>
                    <div class="form-group mb-3">
                        <label class="mb-1 lable-text" asp-for="NewPassword" asp-postfix=":" class="text-info"></label>
                        <input class="input-text" asp-for="NewPassword" class="form-control" />
                    </div>
                    <div class="form-group mb-3">
                        <label class="mb-1 lable-text" asp-for="ConfirmNewPassword" asp-postfix=":" class="text-info"></label>
                        <input class="input-text" asp-for="ConfirmNewPassword" class="form-control" />
                    </div>
                    <div class="forgotandlogin-cmn">
                        <button id="reset-password-btn" class="loginbtn w-100 mb-5 mt-4" type="submit" name="set-password">@T("Account.PasswordRecovery.ChangePasswordButton")</button>
                    </div>
                </form>
            }
        </div>
    </div>
</section>

<script asp-location="Footer">
    $(document).ready(function () {
        $('#reset-password-btn').on('click', function (e) {

            var newPassword = $('#@Html.IdFor(model => model.NewPassword)').val();
            var confirmNewPassword = $('#@Html.IdFor(model => model.ConfirmNewPassword)').val();

            if (!newPassword || !confirmNewPassword) {
                $.alert({
                    title: 'Error',
                    content: 'Please fill in all the required fields.',
                    animation: 'scale',
                    theme: 'modern',
                    type: 'red',
                    closeAnimation: 'bottom',
                    backgroundDismiss: false,
                    buttons: {
                        okay: {
                            text: 'Okay',
                            btnClass: 'btn-red',
                            action: function () {
                            }
                        }
                    }
                });
                return;
            }

            if (newPassword !== confirmNewPassword) {
                $.alert({
                    title: 'Error',
                    content: 'Passwords do not match.',
                    animation: 'scale',
                    theme: 'modern',
                    type: 'red',
                    closeAnimation: 'bottom',
                    backgroundDismiss: false,
                    buttons: {
                        okay: {
                            text: 'Okay',
                            btnClass: 'btn-red',
                            action: function () {
                            }
                        }
                    }
                });
                return;
            }

            $('#password-recovery-form').off('submit').submit();
        });
    });
</script>